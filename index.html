<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>体重・食事目標 自動計算ツール</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: #f7f7f7;
      margin: 0;
      padding: 12px;
    }
    .container {
      max-width: 640px;
      margin: auto;
      background: #fff;
      padding: 16px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    h1 { font-size: 1.3rem; margin-bottom: 16px; }
    .field { margin-bottom: 16px; }
    label { display: block; margin-bottom: 6px; font-weight: 600; }
    input, select {
      width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #ccc; font-size: 1rem;
    }
    .note { margin-top: 6px; font-size: 0.75rem; color: #555; line-height: 1.4; }
    .result { background: #f0f4ff; padding: 16px; border-radius: 8px; margin-top: 24px; }
    .result-row { display: flex; align-items: center; gap: 8px; margin: 12px 0; }
    .result-content { flex: 1; }
    .result-text { font-weight: 600; line-height: 1.4; }
    button.copy {
      background: #2563eb; color: #fff; padding: 10px 12px; border: none; border-radius: 10px;
      cursor: pointer; font-size: 0.95rem; min-width: 96px; font-weight: 700;
    }
    .toast {
      position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
      background: rgba(0,0,0,0.8); color: #fff; padding: 10px 16px; border-radius: 20px;
      font-size: 0.9rem; opacity: 0; transition: opacity 0.3s ease; pointer-events: none; z-index: 999;
    }
    .toast.show { opacity: 1; }
  </style>
</head>
<body>
<div class="container">
  <h1>体重・食事目標 自動計算ツール</h1>

  <div class="field">
    <label>身長（m）</label>
    <input type="number" step="0.01" id="height" placeholder="例：1.70" />
  </div>

  <div class="field">
    <label>現在の体重（kg）</label>
    <input type="number" step="0.1" id="currentWeight" placeholder="例：70" />
  </div>

  <div class="field">
    <label>長期的な目標BMI<br>
      <span class="note">22：積極的に糖尿病予防を目指す場合の目標BMI　/　25：無理なく続けられる目標BMI</span>
    </label>
    <select id="bmi">
      <option value="22" selected>22</option>
      <option value="23">23</option>
      <option value="24">24</option>
      <option value="25">25</option>
    </select>
  </div>

  <div class="field">
    <label>半年後の減量目標<br>
      <span class="note">まず2kgの減量を目標に。出来たら3％〜10％の減量を目標に。</span>
    </label>
    <select id="reduction">
      <optgroup label="体重で設定"><option value="kg_2">−2kg</option></optgroup>
      <optgroup label="減量率で設定">
        <option value="rate_3">3%</option><option value="rate_4">4%</option>
        <option value="rate_5">5%</option><option value="rate_6">6%</option>
        <option value="rate_7">7%</option><option value="rate_8">8%</option>
        <option value="rate_9">9%</option><option value="rate_10">10%</option>
      </optgroup>
    </select>
  </div>

  <div class="field">
    <label>身体活動量</label>
    <div class="note"><strong>30（おすすめ）</strong> 立つ／歩くことが多い生活：接客・販売・家事が多い</div>
    <select id="intake">
      <option value="25">25</option>
      <option value="30" selected>30</option>
      <option value="35">35</option>
    </select>
  </div>

  <div class="result">
    <div class="result-row"><span class="result-text" id="r1">① 長期的な体重目標：— kg</span></div>

    <div class="result-row">
      <div class="result-content">
        <span class="result-text" id="r2">② 半年後の体重目標：— kg</span><br>
        <span class="note">シンクヘルスアプリ「もっと見る ＞ 目標 ＞ 目標体重」に入力</span>
      </div>
      <button class="copy" onclick="copyValue('r2')">ここを押す</button>
    </div>

    <div class="result-row">
      <div class="result-content">
        <span class="result-text" id="r3">③ 食事摂取量の目標：— kcal / 日</span><br>
        <span class="note">シンクヘルスアプリ「もっと見る ＞ 目標 ＞ 食事 ＞ エネルギー」に入力</span>
      </div>
      <button class="copy" onclick="copyValue('r3')">ここを押す</button>
    </div>
  </div>

  <div class="note">※ 本ツールは目安です。入力データは保存・送信されません。</div>
</div>

<script>
  const inputs = document.querySelectorAll('input, select');
  inputs.forEach(el => el.addEventListener('input', calculate));

  function calculate() {
    const h = parseFloat(height.value);
    const w = parseFloat(currentWeight.value);
    if (!h || !w) return;

    const bmiVal = parseFloat(bmi.value);
    const targetYear = h * h * bmiVal;

    let target;
    if (reduction.value.startsWith('rate')) {
      const rate = parseFloat(reduction.value.split('_')[1]);
      target = w * (100 - rate) / 100;
    } else {
      target = w - 2;
    }

    const kcal = target * parseFloat(intake.value);

    r1.textContent = `① 長期的な体重目標：${targetYear.toFixed(1)} kg`;
    r2.textContent = `② 半年後の体重目標：${target.toFixed(1)} kg`;
    r2.dataset.value = target.toFixed(1);
    r3.textContent = `③ 食事摂取量の目標：${Math.round(kcal)} kcal / 日`;
    r3.dataset.value = Math.round(kcal);
  }

  function copyValue(id) {
    const value = document.getElementById(id).dataset.value;
    if (!value) return;

    // Clipboard API が使えない環境向けフォールバック
    const textarea = document.createElement('textarea');
    textarea.value = value;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);

    showToast('数字のみコピーしました');
  }

  function showToast(msg) {
    let toast = document.querySelector('.toast');
    if (!toast) {
      toast = document.createElement('div');
      toast.className = 'toast';
      document.body.appendChild(toast);
    }
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 1200);
  }
</script>
</body>
</html>
