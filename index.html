<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>体重・食事目標 かんたん自動計算ツール</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: #f7f7f7;
      margin: 0;
      padding: 12px;
    }
    .container {
      max-width: 640px;
      margin: auto;
      background: #fff;
      padding: 16px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    h1 { font-size: 1.3rem; margin-bottom: 16px; }
    .field { margin-bottom: 16px; }
    label { display: block; margin-bottom: 6px; font-weight: 600; }
    input, select {
      width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #ccc; font-size: 1rem;
    }
    .note { margin-top: 6px; font-size: 0.75rem; color: #555; line-height: 1.4; }
    .result { background: #f0f4ff; padding: 16px; border-radius: 8px; margin-top: 24px; }
    .result-row {
      display: flex; align-items: center; gap: 6px; margin: 12px 0; flex-wrap: nowrap;
    }
    .result-content { flex: 1; min-width: 0; }
    .result-text { font-weight: 600; }
    .result-value { font-weight: 700; white-space: nowrap; }
    button.copy {
      background: #2563eb; color: #fff; padding: 6px 8px; border: none; border-radius: 6px;
      cursor: pointer; font-size: 0.7rem; min-width: 56px; font-weight: 600; white-space: nowrap;
      flex-shrink: 0;
    }
    .toast {
      position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
      background: rgba(0,0,0,0.8); color: #fff; padding: 10px 16px; border-radius: 20px;
      font-size: 0.9rem; opacity: 0; transition: opacity 0.3s ease; pointer-events: none; z-index: 999;
    }
    .toast.show { opacity: 1; }
  </style>
</head>
<body>
<div class="container">
  <h1>体重・食事目標 かんたん自動計算ツール</h1>

  <div class="field">
    <label>身長（cm）</label>
    <input type="number" step="0.1" id="height" placeholder="例：170" />
  </div>

  <div class="field">
    <label>現在の体重（kg）</label>
    <input type="number" step="0.1" id="currentWeight" placeholder="例：70" />
  </div>

  <div class="field">
    <div class="note" id="stdWeight">あなたの標準体重（BMI22）：— kg</div>
    <div class="note" id="obeseLine">肥満ラインを越えて、健康的な体重の目安（BMI25）：— kg</div>
  </div>

  <div class="field">
    <label>長期的な目標BMI</label>
    <div class="note">22：積極的に糖尿病予防を目指す場合の目標BMI ／ 25：無理なく継続しやすい目標BMI</div>
    <select id="bmi">
      <option value="22" selected>22</option>
      <option value="23">23</option>
      <option value="24">24</option>
      <option value="25">25</option>
    </select>
  </div>

  <div class="field">
    <label>半年後の減量目標</label>
    <div class="note">まずは2kg減量を目標に。可能であれば3〜10％の減量を目指しましょう。</div>
    <select id="reduction">
      <optgroup label="体重で設定">
        <option value="kg_2">−2kg</option>
      </optgroup>
      <optgroup label="減量率で設定">
        <option value="rate_3">3%</option>
        <option value="rate_4">4%</option>
        <option value="rate_5">5%</option>
        <option value="rate_6">6%</option>
        <option value="rate_7">7%</option>
        <option value="rate_8">8%</option>
        <option value="rate_9">9%</option>
        <option value="rate_10">10%</option>
      </optgroup>
    </select>
  </div>

  <div class="field">
    <label>身体活動量</label>
    <div class="note">
      ・<strong>基本コース（×30kcal）</strong>：無理なく標準的に進めたい方（迷ったらこれ！）<br>
      ・しっかり減量コース（×25kcal）：普段あまり動かない方、または少し早めに体重を落としたい方<br>
      ・活動的コース（×35kcal）：立ち仕事や力仕事の方、または運動習慣がしっかりある方
    </div>
    <select id="intake">
      <option value="30" selected>基本コース（30）</option>
      <option value="25">しっかり減量コース（25）</option>
      <option value="35">活動的コース（35）</option>
    </select>
  </div>

  <div class="result">
    <div class="result-row">
      <span class="result-text" id="r1">① 長期的な体重目標：— kg</span>
    </div>

    <div class="result-row">
      <div class="result-content">
        <span class="result-text">② 半年後の体重目標：</span>
        <span class="result-value" id="r2">— kg</span><br>
        <span class="note">シンクヘルスアプリの「もっと見る ＞ 目標 ＞ 目標体重」に入力してください</span>
      </div>
      <button class="copy" onclick="copyValue('r2')">値をコピー</button>
    </div>

    <div class="result-row">
      <div class="result-content">
        <span class="result-text">③ 食事摂取量の目標：</span>
        <span class="result-value" id="r3">— kcal / 日</span><br>
        <span class="note">シンクヘルスアプリの「もっと見る ＞ 目標 ＞ 食事 ＞ カロリー」に入力してください</span>
      </div>
      <button class="copy" onclick="copyValue('r3')">値をコピー</button>
    </div>
  </div>

  <div class="note">※ 本ツールは目安です。入力データは保存・送信されません。</div>
</div>

<script>
  const inputs = document.querySelectorAll('input, select');
  inputs.forEach(el => el.addEventListener('input', calculate));

  function calculate() {
    const hCm = parseFloat(height.value);
    const h = hCm / 100;
    const w = parseFloat(currentWeight.value);
    if (!hCm || !w) return;

    // 減量率オプションに実際の体重を併記
    document.querySelectorAll('#reduction option').forEach(opt => {
      if (opt.value.startsWith('rate')) {
        const rate = parseFloat(opt.value.split('_')[1]);
        const t = w * (100 - rate) / 100;
        opt.textContent = `${rate}%（${t.toFixed(1)}kg）`;
      }
    });

    const bmiVal = parseFloat(bmi.value);
    const targetYear = h * h * bmiVal;

    let target;
    if (reduction.value.startsWith('rate')) {
      const rate = parseFloat(reduction.value.split('_')[1]);
      target = w * (100 - rate) / 100;
    } else {
      target = w - 2;
    }

        // 食事摂取量の目標：BMI22の標準体重 × 身体活動量係数
    const stdForKcal = h * h * 22;
    const kcal = stdForKcal * parseFloat(intake.value);

    r1.textContent = `① 長期的な体重目標：${targetYear.toFixed(1)} kg`;

    const std = h * h * 22;
    const obese = h * h * 25;
    stdWeight.textContent = `あなたの標準体重（BMI22）：${std.toFixed(1)} kg`;
    obeseLine.textContent = `肥満ラインを越えて、健康的な体重の目安（BMI25）：${obese.toFixed(1)} kg`;

    r2.textContent = `${target.toFixed(1)} kg`;
    r2.dataset.value = target.toFixed(1);
    r3.textContent = `${Math.round(kcal)} kcal / 日`;
    r3.dataset.value = Math.round(kcal);
  }

  function copyValue(id) {
    const value = document.getElementById(id).dataset.value;
    if (!value) return;

    const textarea = document.createElement('textarea');
    textarea.value = value;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);

    showToast('数字のみコピーしました');
  }

  function showToast(msg) {
    let toast = document.querySelector('.toast');
    if (!toast) {
      toast = document.createElement('div');
      toast.className = 'toast';
      document.body.appendChild(toast);
    }
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 1200);
  }
</script>
</body>
</html>
